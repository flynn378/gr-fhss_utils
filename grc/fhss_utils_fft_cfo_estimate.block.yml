# auto-generated by grc.converter

id: fhss_utils_fft_cfo_estimate
label: FFT CFO Estimate
category: '[Sandia]/FHSS Utilities'

parameters:
-   id: fftsize
    label: FFT Size
    dtype: int
    default: '1024'
-   id: nffts
    label: nFFTs
    dtype: int
    default: '32'
-   id: offset
    label: Offset
    dtype: int
    default: '0'
-   id: threshold
    label: Threshold
    dtype: float
    default: '3.0'
-   id: valid_freqs
    label: Valid Freqs
    dtype: float_vector
    default: '[]'

inputs:
-   domain: message
    id: pdu_in

outputs:
-   domain: message
    id: pdu_out

templates:
    imports: import fhss_utils
    make: fhss_utils.fft_cfo_estimate(${fftsize}, ${offset}, ${nffts}, ${threshold},
        ${valid_freqs})
    callbacks:
    - set_freqs(${valid_freqs})

documentation: |-
    Estimates and corrects the CFO of a complex PDU burst.

    Does this by skipping the first offset samples, then taking nffts sequential FFTs of size fftsize. The magnitude spectra are averaged. The CFO is taken to be the median of the bins which are within threshold dB of the maximum magnitude.

    The output is frequency shifted by the CFO estimate.

file_format: 1
